version: "3.8"

services:
  cf-analytics:
    build: .
    ports:
      - "80:80"
    environment:
      # 基础配置
      - PORT=4000
      - NGINX_PORT=80

      # Cloudflare配置 - 单账户方式（与README.md docker run命令对应）
      # 请根据实际情况修改以下配置
      - CF_TOKENS=your_cf_token_here
      - CF_ZONES=zone_id_1,zone_id_2
      - CF_DOMAINS=example.com,cdn.example.com
      - CF_ACCOUNT_NAME=我的主账户

      # 多账户配置示例（如需使用，请取消注释并修改）
      # - CF_TOKENS_1=token1
      # - CF_ZONES_1=zone1,zone2
      # - CF_DOMAINS_1=site1.com,site2.com
      # - CF_ACCOUNT_NAME_1=账户1
      # - CF_TOKENS_2=token2
      # - CF_ZONES_2=zone3,zone4
      # - CF_DOMAINS_2=site3.com,site4.com
      # - CF_ACCOUNT_NAME_2=账户2

      # JSON格式配置示例（如需使用，请取消注释并修改，同时注释掉上面的单账户配置）
      # - CF_CONFIG={"accounts":[{"name":"主账号","token":"your_token","zones":[{"zone_id":"zone1","domain":"example.com"},{"zone_id":"zone2","domain":"cdn.example.com"}]}]}

    # 使用.env文件（可选，与环境变量配置二选一）
    # env_file:
    #   - .env

    # 如果使用配置文件方式，取消下面的卷挂载注释
    # volumes:
    #   - ./server/zones.yml:/api/zones.yml:ro

    restart: unless-stopped
